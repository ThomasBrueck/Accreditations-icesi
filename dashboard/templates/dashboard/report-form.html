{% extends 'dashboard/base-dashboard.html' %}
{% load static %}

{% block title %}
  {% if form.instance.pk %}
    Edit Report
  {% else %}
    Create Report
  {% endif %}
{% endblock %}

{% block css_files %}
  <link rel="stylesheet" href="{% static 'dashboard/dashboard.css' %}">
  <link rel="stylesheet" href="{% static 'dashboard/sidebar.css' %}">
  <link rel="stylesheet" href="{% static 'dashboard/reports.css' %}">
  <link rel="stylesheet" href="{% static 'dashboard/include/confirm-window.css' %}">
{% endblock %}

{% block js_files %}
  <script src="{% static 'dashboard/js/confirm-window.js' %}"></script>
{% endblock %}

{% block content %}
  {% include 'dashboard/include/sidebar.html' %}

  <div class="main-content">
    <div class="container py-4">
      <h2 class="mb-4">
        {% if form.instance.pk %}Edit Report{% else %}Create Report{% endif %}
      </h2>

      <form method="post" enctype="multipart/form-data" class="card shadow-sm p-4" id="reportForm">
        {% csrf_token %}
        {% if form.non_field_errors %}
          <div class="alert alert-danger">
            {{ form.non_field_errors }}
          </div>
        {% endif %}

        <div class="mb-3">
          <label for="{{ form.name.id_for_label }}" class="form-label">Name</label>
          {{ form.name }}
        </div>

        <div class="mb-3">
          <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
          {{ form.description }}
        </div>

        <div class="mb-3">
          <label for="{{ form.image.id_for_label }}" class="form-label">Image</label>
          {{ form.image }}
        </div>

        <div class="mb-3">
          <label for="{{ form.end_date.id_for_label }}" class="form-label">End Date</label>
          {{ form.end_date }}
        </div>

        <div class="mb-3">
          <label class="form-label" for="{{ form.status.id_for_label }}">Status</label>
          {{ form.status }}
        </div>

        <div class="d-flex justify-content-end">
          <a href="{% url 'report-list' %}" class="btn btn-outline-secondary me-2">Cancel</a>
          <button type="button" id="triggerModal" class="btn btn-primary">
            {% if form.instance.pk %}Save Changes{% else %}Create Report{% endif %}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal -->
  <div id="customModal" class="custom-modal">
    <div class="custom-modal-content">
      <h5 class="mb-3">
        {% if form.instance.pk %}Confirm Edit{% else %}Are you sure?{% endif %}
      </h5>
      <p>
        {% if form.instance.pk %}
          Confirm if you want to update this report.
        {% else %}
          Confirm if you want to create this report.
        {% endif %}
      </p>
      <div class="d-flex justify-content-end gap-2 mt-4">
        <button type="button" id="cancelModal" class="btn btn-outline-secondary">Cancel</button>
        <button type="button" id="submitReport" class="btn btn-primary">
          {% if form.instance.pk %}Save{% else %}Create{% endif %}
        </button>
      </div>
    </div>
  </div>
{% endblock %}
